<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="description" content="How to build mobile apps using Meteor&apos;s Cordova integration.">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Mobile | Meteor Guide</title>
    <link rel="icon" href="https://www.meteor.com/favicon.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,300italic,400italic" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="http://guide.meteor.com/style/main.css">
    <link href="http://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="http://s.swiftypecdn.com/assets/new_embed-d6004936e85bea3a6779a7de0ff4f850.css"><style type="text/css">.st-install-h1KW95Mz3fNyf4cnqVtr .st-ui-result .st-ui-type-heading { color:#0089d7 !important }
.st-install-h1KW95Mz3fNyf4cnqVtr .st-ui-result em {font-style:normal; font-weight:bold; background-color:#f6fcfe !important}</style><style>.original{display:none}</style></head>
  <body>
    <div id="wrap">
  <div id="header">
    <div id="top-nav">
  <ul id="top-nav-links">
    
      <li><a href="https://www.meteor.com">Meteor.com</a></li>
    
      <li><a href="https://www.meteor.com/install">Install</a></li>
    
      <li><a href="http://guide.meteor.com">Guide</a></li>
    
      <li><a href="https://www.meteor.com/tutorials/blaze/creating-an-app">Tutorials</a></li>
    
      <li><a href="http://docs.meteor.com">Docs</a></li>
    
      <li><a href="https://forums.meteor.com/">Forums</a></li>
    
  </ul>
</div>

<div id="site-nav">
  <a class="logo" href="/"><img src="http://guide.meteor.com/images/logo-coralspace.svg"></a>
  <span class="sub-title">The Official Guide</span>
  
    <select class="version-select">
      
        <option value="v1.3">1.3</option>
      
        <option value="v1.2">1.2</option>
      
    </select>
  
  
    <input id="search-input" class="search-box st-default-search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
  
</div>

  </div>
  <div id="sidebar">
    <div id="sidebar-mobile">
  <!--
     Disabled search since it doesn't seem to work well
    <input class="search-box st-default-search-input">
    <br>
  -->
  <select class="version-select">
    
      <option value="v1.3">v1.3</option>
    
      <option value="v1.2">v1.2</option>
    
  </select>
</div>

<ul class="categories">
  
    <li>
      
      <ul class="menu-root">
        
          
          <li>
            <a href="guide-1.3.html" class="sidebar-link">
              Introduction
            </a>
          </li>
        
          
          <li>
            <a href="guide-code-style-1.3.html" class="sidebar-link">
              Code style
            </a>
          </li>
        
          
          <li>
            <a href="guide-structure-1.3.html" class="sidebar-link">
              Application structure
            </a>
          </li>
        
          
          <li>
            <a href="guide-1.3-migration-1.3.html" class="sidebar-link">
              Migrating to Meteor 1.3
            </a>
          </li>
        
      </ul>
    </li>
  
    <li>
      
        <p>Data</p>
      
      <ul class="menu-root">
        
          
          <li>
            <a href="guide-collections-1.3.html" class="sidebar-link">
              Collections and Schemas
            </a>
          </li>
        
          
          <li>
            <a href="guide-data-loading-1.3.html" class="sidebar-link">
              Publications and Data Loading
            </a>
          </li>
        
          
          <li>
            <a href="guide-methods-1.3.html" class="sidebar-link">
              Methods
            </a>
          </li>
        
          
          <li>
            <a href="guide-accounts-1.3.html" class="sidebar-link">
              Users and Accounts
            </a>
          </li>
        
          
          <li>
            <a href="guide-testing-1.3.html" class="sidebar-link">
              Testing
            </a>
          </li>
        
      </ul>
    </li>
  
    <li>
      
        <p>View</p>
      
      <ul class="menu-root">
        
          
          <li>
            <a href="guide-routing-1.3.html" class="sidebar-link">
              URLs and Routing
            </a>
          </li>
        
          
          <li>
            <a href="guide-ui-ux-1.3.html" class="sidebar-link">
              User Interfaces
            </a>
          </li>
        
          
          <li>
            <a href="guide-blaze-1.3.html" class="sidebar-link">
              Blaze
            </a>
          </li>
        
          
          <li>
            <a href="guide-react-1.3.html" class="sidebar-link">
              React
            </a>
          </li>
        
          
          <li>
            <a href="guide-angular-1.3.html" class="sidebar-link">
              Angular
            </a>
          </li>
        
      </ul>
    </li>
  
    <li>
      
        <p>Build</p>
      
      <ul class="menu-root">
        
          
          <li>
            <a href="guide-using-packages-1.3.html" class="sidebar-link">
              Using Packages
            </a>
          </li>
        
          
          <li>
            <a href="guide-writing-packages-1.3.html" class="sidebar-link">
              Writing Packages
            </a>
          </li>
        
          
          <li>
            <a href="" class="sidebar-link current">
              Mobile
            </a>
          <ul class="sub-menu"><li><a href="#introduction" data-scroll="" class="H2">Introduction to Meteor’s built-in mobile integration</a><ul class="sub-menu"><li><a href="#cordova-integration-in-meteor" data-scroll="" class="H3">How does the Cordova integration in Meteor work?</a></li><li><a href="#what-environment" data-scroll="" class="H3">What environment does your Cordova app run in?</a></li><li><a href="#adding-platforms" data-scroll="" class="H3">Adding Cordova platforms to your app</a></li></ul></li><li><a href="#installing-prerequisites" data-scroll="" class="H2">Installing prerequisites</a><ul class="sub-menu"><li><a href="#installing-prerequisites-ios" data-scroll="" class="H3">iOS</a></li><li><a href="#installing-prerequisites-android" data-scroll="" class="H3">Android</a></li></ul></li><li><a href="#running-your-app" data-scroll="" class="H2">Running your app on a mobile device for development</a><ul class="sub-menu"><li><a href="#running-on-ios" data-scroll="" class="H3">How to run your app on an iOS device</a></li><li><a href="#running-on-android" data-scroll="" class="H3">How to run your app on an Android device</a></li></ul></li><li><a href="#logging-and-remote-debugging" data-scroll="" class="H2">Using logging and remote debugging tools</a><ul class="sub-menu"><li><a href="#understanding=logs" data-scroll="" class="H3">Understanding the different types of logs</a></li><li><a href="#remote-debugging-ios" data-scroll="" class="H3">How to remote debug your iOS app with Safari</a></li><li><a href="#remote-debugging-android" data-scroll="" class="H3">How to remote debug your Android app with Chrome</a></li></ul></li><li><a href="#hot-code-push" data-scroll="" class="H2">Hot code push on mobile</a><ul class="sub-menu"><li><a href="#updating-production-apps" data-scroll="" class="H3">Updating apps in production</a></li><li><a href="#configuring-server-for-hot-code-push" data-scroll="" class="H3">Configuring your server for hot code push</a></li><li><a href="#recovering-from-faulty-versions" data-scroll="" class="H3">Recovering from faulty versions</a></li></ul></li><li><a href="#cordova-plugins" data-scroll="" class="H2">Using native device features with Cordova plugins</a><ul class="sub-menu"><li><a href="#installing-plugins" data-scroll="" class="H3">Installing plugins</a></li><li><a href="#using-plugins" data-scroll="" class="H3">Using plugins</a></li><li><a href="#cordova-specific-javascript" data-scroll="" class="H3">Adding Cordova-specific Javascript code to your application</a></li></ul></li><li><a href="#accessing-local-files-and-remote-resources" data-scroll="" class="H2">Accessing local files and remote resources</a><ul class="sub-menu"><li><a href="#accessing-local-files" data-scroll="" class="H3">Accessing local files</a></li><li><a href="#accessing-local-files" data-scroll="" class="H3">Domain whitelisting</a></li><li><a href="#csp" data-scroll="" class="H3">Content Security Policy (CSP)</a></li><li><a href="#cors" data-scroll="" class="H3">Cross-Origin Resource Sharing (CORS)</a></li></ul></li><li><a href="#configuring-your-app" data-scroll="" class="H2">Configuring your app</a><ul class="sub-menu"><li><a href="#configuring-metadata" data-scroll="" class="H3">Metadata</a></li><li><a href="#configuring-preferences" data-scroll="" class="H3">Preferences</a></li><li><a href="#configuring-app-icons-and-launch-screens" data-scroll="" class="H3">App icons and launch screens</a></li><li><a href="#advanced-build" data-scroll="" class="H3">Advanced build customization</a></li></ul></li><li><a href="#building-and-submitting" data-scroll="" class="H2">Submitting your mobile app to the store</a><ul class="sub-menu"><li><a href="#building-for-production" data-scroll="" class="H3">Building your mobile app for production</a></li><li><a href="#submitting-ios" data-scroll="" class="H3">How to submit your iOS app to the App Store</a></li><li><a href="#submitting-android" data-scroll="" class="H3">How to submit your Android app to the Play Store</a></li></ul></li></ul></li>
        
          
          <li>
            <a href="guide-build-tool-1.3.html" class="sidebar-link">
              Build system
            </a>
          </li>
        
      </ul>
    </li>
  
    <li>
      
        <p>Production</p>
      
      <ul class="menu-root">
        
          
          <li>
            <a href="guide-security-1.3.html" class="sidebar-link">
              Security
            </a>
          </li>
        
          
          <li>
            <a href="guide-deployment-1.3.html" class="sidebar-link">
              Deployment and Monitoring
            </a>
          </li>
        
      </ul>
    </li>
  
    <li>
      
        <p>Meta</p>
      
      <ul class="menu-root">
        
          
          <li>
            <a href="guide-CONTRIBUTING-1.3.html" class="sidebar-link">
              Contribution guidelines
            </a>
          </li>
        
          
          <li>
            <a href="guide-CHANGELOG-1.3.html" class="sidebar-link">
              Change log
            </a>
          </li>
        
      </ul>
    </li>
  

  </ul></div>
  <div id="content">
    <h1>Mobile</h1>
    <p class="edit-discuss-links">
      <a href="https://github.com/meteor/guide/tree/master/content/mobile.md" target="_blank">Edit on GitHub</a>
      
        |
        <a href="https://forums.meteor.com/t/20195">Discuss on the Meteor Forums</a>
      
    </p>
    <p class="original">After reading this guide, you’ll know:</p>
<p class="translation">このガイドを読むと、以下のことがわかります：</p>
<ol>
<li>What Cordova is, and how Meteor integrates with it to build mobile apps from a single codebase</li>
<li>How to set up your local machine for mobile development</li>
<li>How to run and debug your app on a mobile device or simulator/emulator</li>
<li>How hot code push allows you to update your mobile app’s code without reinstalling the app on your device or submitting a new version to the store</li>
<li>How to use Cordova plugins to take advantage of native device features</li>
<li>How to access local files and remote resources from your app</li>
<li>What you can do to create a good mobile user experience for your app</li>
<li>How to configure your app to use your own app icon, launch screen, and set other preferences</li>
<li>How to build your project and submit your mobile app to the store</li>
</ol>
<h2 id="introduction"><a class="anchor" href="#introduction" aria-hidden="true" data-scroll="">&#x1F517;</a>Introduction to Meteor’s built-in mobile integration</h2>

<p>Meteor integrates with <a href="https://cordova.apache.org" target="_blank" rel="external">Cordova</a>, a well-known Apache open source project, to build mobile apps from the same codebase you use to create regular web apps. With the Cordova integration in Meteor, you can take your existing app and run it on an iOS or Android device with a few simple commands.</p>
<p>A Cordova app is a web app written using HTML, CSS, and JavaScript as usual, but it runs in a <a href="#what-environment">web view</a> embedded in a native app instead of in a stand-alone mobile browser. An important benefit of packaging up your web app as a Cordova app is that all your assets are bundled with the app. This ensures your app will load faster than a web app running on a remote server could, which can make a huge difference for users on slow mobile connections. Another feature of the Cordova integration in Meteor is support for <a href="#hot-code-push">hot code push</a>, which allows you to update your app on users’ devices without going through the usual app store review process.</p>
<p>Cordova also opens up access to certain native device features through a <a href="#cordova-plugins">plugin architecture</a>. Plugins allow you to use features not usually available to web apps, such as accessing the device camera or the local file system, interact with barcode or NFC readers, etc.</p>
<p>Because a Cordova app is  a web app, this means you use standard web elements to create your user interface instead of relying on platform-specific native UI components. Creating a good mobile user experience is an art in itself, but is fortunately helped by the availability of various frameworks and libraries.</p>
<blockquote>
<h4 id="what-about-phonegap">What about PhoneGap?</h4>

<p>You may have heard of PhoneGap, and wonder how it relates to Cordova. PhoneGap is a product name used by Adobe since 2011, when they acquired a company called Nitobi, the original creators of what is now the Cordova project. When Adobe donated the code to Apache in 2012 to ensure a more open governance model, the open source project was rebranded as Cordova. PhoneGap is now one of the distributions of Cordova, on a par with other distributions like Ionic, Telerik, Monaca, or Intel XDK. These distributions mainly differ in tooling and integration with cloud services, but they share the underlying platform and plugins. Meteor could also be considered a Cordova distribution.</p>
</blockquote>
<h3 id="cordova-integration-in-meteor"><a class="anchor" href="#cordova-integration-in-meteor" aria-hidden="true" data-scroll="">&#x1F517;</a>How does the Cordova integration in Meteor work?</h3>

<p>With Meteor, there is no need to install Cordova yourself, or use the <code>cordova</code> command directly. Cordova project creation happens as part of the Meteor run and build commands, and the project itself is considered a build artifact (stored in <code>.meteor/local/cordova-build</code> in your app directory) that can be deleted and recreated at any time. Instead of having you modify Cordova’s <code>config.xml</code> file, Meteor reads a <a href="http://docs.meteor.com/#/full/mobileconfigjs" target="_blank" rel="external"><code>mobile-config.js</code></a> file in the root of your app directory and uses the settings specified there to configure the generated project.</p>
<p>Cordova apps don’t load web content over the network, but rely on locally stored HTML, CSS, JavaScript code and other assets. While Cordova by default uses <code>file://</code> URLs to load the app, Meteor includes an integrated file serving mechanism on the device to support both bundling the initial assets and incrementally updating your app through <a href="#hot-code-push">hot code push</a>. This means your app will be served from <code>http://localhost:&lt;port&gt;</code>, which also has the benefit that web views consider it a <a href="https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features" target="_blank" rel="external">secure origin</a> and won’t block any sensitive features (which they increasingly do for <code>file://</code> URLs).</p>
<blockquote>
<h4 id="what-port">What port will your app be served from?</h4>

<p>While Meteor uses a built-in request interception mechanism on Android, supporting <code>WKWebView</code> on iOS requires running a real embedded web server instead. That means the local web server needs a port to bind to, and we can’t simply use a fixed port because that might lead to conflicts when running multiple Meteor Cordova apps on the same device. The easiest solution may seem to use a randomized port, but this has a serious drawback: if the port changes each time you run the app, web features that depend on the origin (like caching, localStorage, IndexedDB) won’t persist between runs, and you also wouldn’t be able to specify a stable OAuth redirect URL. So instead we now pick a port from a predetermined range (12000-13000), calculated based on the <code>appId</code>, a unique identifier that is part of every Meteor project. That ensures the same app will always use the same port, but it hopefully avoids collisions betweens apps as much as possible. (There is still a theoretical possibility of the selected port being in use. Currently, starting the local server will fail in that case.)</p>
</blockquote>
<h3 id="what-environment"><a class="anchor" href="#what-environment" aria-hidden="true" data-scroll="">&#x1F517;</a>What environment does your Cordova app run in?</h3>

<p>Cordova apps run in a web view. A web view is basically a browser without the browser UI. Browser engines differ in their underlying implementation and in what web standards they support. As a result, what web view your app runs on can have a huge impact on your app’s performance and on the features you get to use. (If you want to know what features are supported on what browsers and versions, <a href="http://caniuse.com" target="_blank" rel="external">caniuse.com</a> is a great resource.)</p>
<h4 id="what-environment-ios">iOS</h4>

<p>The browser on iOS is Safari, which is based on the open source WebKit project, but tends to be somewhat slow in enabling new features. Because they use the same underlying framework, the features available to a web view match the features supported by Safari on the iOS release you’re running on.</p>
<p>Meteor uses WKWebView by default, on both iOS 8 and iOS 9. WKWebView is part of the modern WebKit API introduced in iOS 8, and replaces UIWebView, which has been in iOS from the beginning. Its main benefit is that it runs in a separate process, allowing for much higher JavaScript performance (3–4x in some benchmarks!) because it can take advantage of Just-In-Time compilation (which UIWebView, running in the same process as your app, cannot do for security reasons).</p>
<blockquote>
<p>You may be aware that WKWebView on iOS 8 doesn’t allow files to be loaded from the local filesystem. This is problematic for standard Cordova apps, because these use <code>file://</code> URLs to load the app. But because the Meteor integration serves assets from <code>localhost</code>, WKWebView works fine on both iOS 8 and iOS 9.</p>
</blockquote>
<h4 id="what-environment-android">Android</h4>

<p>The web view situation on Android is a little more complicated. On older Android versions, the included web view is known to be rather slow and buggy. That improved somewhat with Android 4.4, which includes a web view based on Chromium, the open source project behind the Chrome browser.</p>
<p>Android 5.0 also comes with a web view based on Chromium known as the <a href="https://play.google.com/store/apps/details?id=com.google.android.webview&amp;hl=en" target="_blank" rel="external">Android System Web View</a>, but a big improvement is that it can be automatically updated through the Play Store. This means updates to the web view happen more regularly and are independent of OS updates.</p>
<p>This threatens to leave many older Android devices behind however, because they would be stuck on the web view included with the OS and are often unable to update to newer OS versions. Fortunately, the <a href="https://crosswalk-project.org/documentation/cordova.html" target="_blank" rel="external">Crosswalk plugin</a> allows you to embed Chromium in your app and use it instead of the web view that comes with the OS on any of the Android versions supported by Cordova (currently Android 4.0 or higher). Embedding Chromium means the size of your APK will grow by about 20MB, but the benefit is that you can rely on a consistent web view with considerably better performance and enhanced standards support.</p>
<p>You can add the Crosswalk plugin to your app with <code>meteor add crosswalk</code>.</p>
<blockquote>
<p>If you receive an error message trying to run the app on your device after adding or removing the Crosswalk plugin, you may have to remove the existing app from your device first.</p>
</blockquote>
<h3 id="adding-platforms"><a class="anchor" href="#adding-platforms" aria-hidden="true" data-scroll="">&#x1F517;</a>Adding Cordova platforms to your app</h3>

<p>Every Meteor project targets a set of platforms. Platforms can be added to a Meteor project with <code>meteor add-platform</code>.</p>
<ul>
<li><code>meteor add-platform ios</code> adds the iOS platform to a project.</li>
<li><code>meteor add-platform android</code> adds the Android platform to a project.</li>
<li><code>meteor remove-platform ios android</code> will remove the iOS and Android platforms from a project.</li>
<li><code>meteor list-platforms</code> lists the platforms targeted by your project.</li>
</ul>
<p>If your local machine does not (yet) fulfill the <a href="#installing-prerequisites">prerequisites</a> for building apps for a mobile platform, an error message with a list of missing requirements is printed (but the platform is still added). You will have to make sure these requirements are fulfilled before you’re able to build and run mobile apps from your machine.</p>
<h2 id="installing-prerequisites"><a class="anchor" href="#installing-prerequisites" aria-hidden="true" data-scroll="">&#x1F517;</a>Installing prerequisites</h2>

<p>In order to build and run mobile apps, you will need to install some prerequisites on your local machine.</p>
<h3 id="installing-prerequisites-ios"><a class="anchor" href="#installing-prerequisites-ios" aria-hidden="true" data-scroll="">&#x1F517;</a>iOS</h3>

<p>In order to build and run iOS apps, you will need a Mac with Xcode 7.2 or higher installed.</p>
<h4>Installing Xcode from the App Store</h4>

<p><code>meteor add-platform ios</code> will open a dialog asking you whether you want to install the ‘command line developer tools’. Do not select ‘Install’ here, because a full Xcode installation is required to build and run iOS apps. Instead, selecting ‘Get Xcode’ will open the Mac App Store page for Xcode and you can click install there. (Alternatively, you can open the Mac App Store and search for ‘Xcode’ to get to that same page.)</p>
<h4>Accepting the license agreement</h4>

<p>After the download and installation completes, you will need to accept the license agreement. If you start Xcode for the first time, a dialog will pop up where you can read the license agreement and accept it. You can close Xcode directly afterwards.</p>
<p>A shortcut is to run <code>sudo xcodebuild -license accept</code> from the command line. (You will still be expected to have read and understood the <a href="https://www.apple.com/legal/sla/docs/xcode.pdf" target="_blank" rel="external">Xcode and Apple SDKs Agreement</a>).</p>
<h3 id="installing-prerequisites-android"><a class="anchor" href="#installing-prerequisites-android" aria-hidden="true" data-scroll="">&#x1F517;</a>Android</h3>

<p>In order to build and run Android apps, you will need to:</p>
<ul>
<li>Install a Java Development Kit (JDK)</li>
<li>Install the Android SDK and download the required tools, platforms, and other components (which is done most easily by installing Android Studio)</li>
<li>Set <code>ANDROID_HOME</code> and add the tools directories to your <code>PATH</code></li>
<li>Optionally: Create an Android Virtual Device to run apps on an emulator</li>
</ul>
<h4>Installing the Java Development Kit (JDK)</h4>

<blockquote>
<p>On Linux, you may want to use your distribution’s package manager to install a JDK; on Ubuntu, you can even use <a href="#ubuntu-make">Ubuntu Make</a> to install Android Studio and all dependencies at the same time.</p>
</blockquote>
<ol>
<li>Open the <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="external">Oracle Java website</a>, and select the Java Platform (JDK)</li>
<li>Check the box to accept the license agreement, and select the correct download for your platform</li>
<li>After it has downloaded, launch the installer, and complete the installation steps</li>
</ol>
<h4>Installing Android Studio</h4>

<p>The easiest way to get a working Android development environment is by installing <a href="http://developer.android.com/sdk/index.html" target="_blank" rel="external">Android Studio</a>, which offers a setup wizard on first launch that installs the Android SDK for you, and downloads a default set of tools, platforms, and other components that you will need to start developing.</p>
<p>Please refer to <a href="http://developer.android.com/sdk/installing/index.html?pkg=studio" target="_blank" rel="external">the Android Studio installation instructions</a> for more details on the exact steps to follow.</p>
<blockquote>
<p>There is no need to use Android Studio if you prefer a stand-alone install. Just make sure you install the most recent versions of the <a href="http://developer.android.com/sdk/index.html#Other" target="_blank" rel="external">Android SDK Tools</a> and download the required <a href="http://developer.android.com/sdk/installing/adding-packages.html" target="_blank" rel="external">additional packages</a> yourself using the <a href="http://developer.android.com/tools/help/sdk-manager.html" target="_blank" rel="external">Android SDK Manager</a>. Make sure to select SDK Platform API 23, because that is what the version of Cordova we bundle requires.</p>
</blockquote>
<h4 id="ubuntu-make">Using Ubuntu Make</h4>

<p>If you’re running Ubuntu, the easiest way to install both a Java Development Kit and Android Studio is by using <a href="https://wiki.ubuntu.com/ubuntu-make" target="_blank" rel="external">Ubuntu Make</a>, a command line tool that sets up development environments and dependencies for you.</p>
<p>If you’re on Ubuntu 14.04 LTS, you’ll have to add the Ubuntu Make ppa first:</p>
<ul>
<li><code>sudo add-apt-repository ppa:ubuntu-desktop/ubuntu-make</code></li>
<li><code>sudo apt-get update</code></li>
</ul>
<p>Then, you can install Ubuntu Make itself:</p>
<ul>
<li><code>sudo apt-get install ubuntu-make</code></li>
</ul>
<p>And finally you use Ubuntu Make to install Android Studio and all dependencies:</p>
<ul>
<li><code>umake android</code></li>
</ul>
<h4>Setting <code>ANDROID_HOME</code> and adding the tools directories to your <code>PATH</code></h4>

<p>Cordova will detect an Android SDK installed in various standard locations automatically, but in order to use tools like <code>android</code> or <code>adb</code> from the terminal, you will have to make some changes to your environment.</p>
<h5>Mac</h5>

<ul>
<li>Set the <code>ANDROID_HOME</code> environment variable to the location of the Android SDK. If you’ve used the Android Studio setup wizard, it should be installed in <code>~/Library/Android/sdk</code> by default.</li>
<li>Add <code>$ANDROID_HOME/tools</code>, and <code>$ANDROID_HOME/platform-tools</code> to your <code>PATH</code></li>
</ul>
<p>You can do this by adding these lines to your <code>~/.bash_profile</code> file (or the equivalent file for your shell environment, like <code>~/.zshrc</code>):<br></p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Android</span></span><br><span class="line"><span class="built_in">export</span> ANDROID_HOME=<span class="string">&quot;/Users/&lt;username&gt;/Library/Android/sdk&quot;</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ANDROID_HOME</span>/tools:<span class="variable">$ANDROID_HOME</span>/platform-tools</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>You will then have to reload <code>.bash_profile</code> (by executing <code>source ~/.bash_profile</code>) or open a new terminal session to apply the new environment.</p>
<h4>Optionally: Creating an Android Virtual Device (AVD) to run apps on an emulator</h4>

<p>The current Android emulator tends to be rather slow and can be unstable, so our recommendation is to run your app on a physical device instead.</p>
<p>If you do want to run on an emulator however, you will have to create an Android Virtual Device (AVD) using the <a href="http://developer.android.com/tools/devices/managing-avds.html" target="_blank" rel="external">AVD Manager</a>. Make sure to configure one with API level 23, because that is what the version of Cordova we bundle requires.</p>
<h2 id="running-your-app"><a class="anchor" href="#running-your-app" aria-hidden="true" data-scroll="">&#x1F517;</a>Running your app on a mobile device for development</h2>

<p>During development, the Meteor <a href="guide-build-tool-1.3.html">build tool</a> integrates with Cordova to run your app on a physical device or the iOS Simulator/Android emulator. In addition to starting a development server and MongoDB instance as usual, <code>meteor run</code> accepts arguments to run the app on one or more mobile targets:</p>
<ul>
<li><code>ios</code>: Runs the app on the iOS Simulator<blockquote>
<p>Currently, this will always run your app on a simulated iPhone 6s Plus. Use <code>ios-device</code> to open Xcode and select another simulator instead.</p>
</blockquote>
</li>
<li><code>ios-device</code>: Opens Xcode, where you can run the app on a connected iOS device or simulator</li>
<li><code>android</code>: Runs the app on the Android emulator<blockquote>
<p>The current Android emulator tends to be rather slow and can be unstable. Our recommendation is to run on a physical device or to use an alternative emulator like <a href="https://www.genymotion.com" target="_blank" rel="external">Genymotion</a>.</p>
</blockquote>
</li>
<li><code>android-device</code>: Runs the app on a connected Android device</li>
</ul>
<p>You can specify multiple targets, so <code>meteor run ios android-device</code> will run the app on both the iOS Simulator and an Android device for example.</p>
<h4 id="connecting-to-the-server">Connecting to the server</h4>

<p>A Meteor app should be able to connect to a server in order to load data and to enable <a href="#hot-code-push">hot code push</a>, which automatically updates a running app when you make changes to its files. During development, this means the device and the computer you run <code>meteor</code> on will have to be part of the same WiFi network, and the network configuration shouldn’t prevent the device from reaching the server. You may have to change your firewall or router settings to allow for this (no client isolation).</p>
<p><code>meteor run</code> will try to detect the local IP address of the computer running the command automatically. If this fails, or if you would like your mobile app to connect to a different server, you can specify an address using the <code>--mobile-server</code> option.</p>
<h3 id="running-on-ios"><a class="anchor" href="#running-on-ios" aria-hidden="true" data-scroll="">&#x1F517;</a>How to run your app on an iOS device</h3>

<blockquote>
<p>Note: If you haven’t previously developed iOS apps, or haven’t used the connected device for development, a series of dialogs and warnings may appear as Xcode resolves code signing issues. It may also prompt you for permission to access the key in your keychain. See <a href="https://developer.apple.com/library/mac/documentation/IDEs/Conceptual/AppDistributionGuide/LaunchingYourApponDevices/LaunchingYourApponDevices.html#//apple_ref/doc/uid/TP40012582-CH27-SW4" target="_blank" rel="external">Apple’s instructions</a> for more information.</p>
</blockquote>
<ol>
<li>Make sure the device is connected to your computer via a USB cable.</li>
<li>Connect the device to a WiFi network that allows for communication with the server.</li>
<li>Run <code>meteor run ios-device</code> to open your project in Xcode.</li>
<li>In the project navigator, choose your device from the Scheme toolbar menu:<br><img src="http://guide.meteor.com/images/mobile/xcode-select-device.png" style="width: 30%; height: 30%"></li>
<li>Click the Run button:<br><img src="http://guide.meteor.com/images/mobile/xcode-run-scheme.png" style="width: 50%; height: 50%"></li>
<li>Xcode builds the app, installs it on the device, and launches it.</li>
</ol>
<h3 id="running-on-android"><a class="anchor" href="#running-on-android" aria-hidden="true" data-scroll="">&#x1F517;</a>How to run your app on an Android device</h3>

<ol>
<li>Make sure the device is connected to your computer via a USB cable.</li>
<li>Connect the device to a WiFi network that allows for communication with the server.</li>
<li>Make sure your device is set up for development <a href="http://developer.android.com/tools/device.html#setting-up" target="_blank" rel="external">as explained here</a>.</li>
<li>You may also need to click ‘Allow’ on the <code>Allow USB debugging?</code> prompt on the device.</li>
<li>Run <code>meteor run android-device</code> to build the app, install it on the device, and launch it.</li>
</ol>
<blockquote>
<p>To check if your device has been connected and set up correctly, you can run <code>adb devices</code> to get a list of devices.</p>
</blockquote>
<h2 id="logging-and-remote-debugging"><a class="anchor" href="#logging-and-remote-debugging" aria-hidden="true" data-scroll="">&#x1F517;</a>Using logging and remote debugging tools</h2>

<p>A full-stack mobile app consists of many moving parts, and this can make it difficult to diagnose issues. Logging is indispensable in keeping track of what’s going on in your app, and may show warnings and errors that you would otherwise miss. Even more powerful is remote debugging, which is the ability to interact with a mobile app running on a remote device from a debugging interface in Safari (for iOS) or Chrome (for Android).</p>
<h3 id="understanding=logs"><a class="anchor" href="#understanding=logs" aria-hidden="true" data-scroll="">&#x1F517;</a>Understanding the different types of logs</h3>

<p>You will encounter three types of logs in a Meteor Cordova app:</p>
<ul>
<li><strong>Server-side logs</strong> - Messages printed by the Meteor build system, and the result of <code>console</code> logging calls from server-side code.</li>
<li><strong>Client-side web logs</strong> - Warnings and errors from the web view, and the result of <code>console</code> logging calls from client-side code.</li>
<li><strong>Client-side native logs</strong> - Messages from system components and Cordova plugins. This also includes more detailed logging from the Meteor plugin used for <a href="#hot-code-push">hot code push</a>.</li>
</ul>
<p>When using <code>meteor run</code>, server-side logs will be printed in the terminal as usual. In addition, running on an Android device or emulator will print a subset of the logs to that same terminal (these logs also include <code>console</code> logging calls made from client-side code).</p>
<p>Running on iOS will not show client-side logs in the terminal, but Xcode will show native logs as usual in the <a href="https://developer.apple.com/library/tvos/documentation/DeveloperTools/Conceptual/debugging_with_xcode/chapters/debugging_tools.html" target="_blank" rel="external">debug console</a>. You can add <a href="https://github.com/apache/cordova-plugin-console" target="_blank" rel="external">cordova-plugin-console</a> to your project to output  <code>console</code> logging calls to the native logs (which Android does by default), but this isn’t recommended because it has a substantial performance impact, and remote debugging gives you much nicer and more complete console output.</p>
<p>Although having client-side logs in the terminal can be useful, in most cases remote debugging is a much better option. This allows you to use the debugging tools built into Safari (for iOS apps) or Chrome (for Android apps) to investigate an app running on a remote device or a simulator/emulator. Here, you can not only view the logs, but also interact with running JavaScript code and the DOM, monitor network access, etc.</p>
<h3 id="remote-debugging-ios"><a class="anchor" href="#remote-debugging-ios" aria-hidden="true" data-scroll="">&#x1F517;</a>How to remote debug your iOS app with Safari</h3>

<ol>
<li><p>To use remote debugging in Safari, you’ll first need to enable the Developer menu. Go to <em>Safari &gt; Preferences</em> and make sure ‘Show Develop menu in menu bar’ is checked:<br><img src="http://guide.meteor.com/images/mobile/mac-safari-preferences-show-develop-menu.png"></p>
</li>
<li><p>You’ll also need to enable the Web Inspector on your iOS device. Go to <em>Settings &gt; Safari &gt; Advanced</em> and enable ‘Web Inspector’:<br><img src="http://guide.meteor.com/images/mobile/ios-safari-settings-web-inspector.png" style="width: 75%; height: 75%"></p>
</li>
<li><p>Launch the app on your device and open remote debugger by choosing <em>Develop &gt; &lt;Your device&gt; &gt; &lt;Your app&gt;/localhost</em>.</p>
</li>
<li><p>Because you can only connect to your app after it has started up, you sometimes miss startup warnings and errors. You can invoke <code>location.reload()</code> in the Web Inspector console to reload a running app, this time with the remote debugger connected.</p>
</li>
</ol>
<p>You can find more information about remote debugging in the <a href="https://developer.apple.com/library/safari/documentation/AppleApplications/Conceptual/Safari_Developer_Guide/" target="_blank" rel="external">Safari Developer Guide</a>.</p>
<h3 id="remote-debugging-android"><a class="anchor" href="#remote-debugging-android" aria-hidden="true" data-scroll="">&#x1F517;</a>How to remote debug your Android app with Chrome</h3>

<p>See <a href="https://developers.google.com/web/tools/chrome-devtools/debug/remote-debugging/remote-debugging#remote-debugging-on-android-with-chrome-devtools" target="_blank" rel="external">this article</a> for instructions on how to remote debug your Android app with the Chrome DevTools.</p>
<ul>
<li>Because you can only connect to your app after it has started up, you sometimes miss startup warnings and errors. You can invoke <code>location.reload()</code> in the DevTools console to reload a running app, this time with the remote debugger connected.</li>
</ul>
<h2 id="hot-code-push"><a class="anchor" href="#hot-code-push" aria-hidden="true" data-scroll="">&#x1F517;</a>Hot code push on mobile</h2>

<p>During development, the Meteor <a href="guide-build-tool-1.3.html">build tool</a> detects any relevant file changes, recompiles the necessary files, and notifies all connected clients a new version is available. Clients can then automatically reload the app, switching over to the new version of the code. This is referred to as <em>hot code push</em>.</p>
<p>Meteor supports hot code push on both browser and mobile clients, but the process on mobile is a bit different. In a browser, reloading the app will re-request assets from the server, and the server will respond with the most recent versions. Because Cordova apps rely on locally stored assets however, hot code push on mobile is a two step process:</p>
<ol>
<li>Updated assets are downloaded from the server using native downloading mechanisms, and stored on the device</li>
<li>The page is reloaded and the web view re-requests the assets from the local web server</li>
</ol>
<p>An important benefit of this is that while downloading may be slow over mobile connections, this is done in the background, and we won’t attempt to reload the app until all assets have been downloaded to the device.</p>
<p>Downloading updates is done incrementally, so we only download assets that have actually changed (based on a content hash). In addition, if we haven’t been able to download all changed assets in one go, because of a network failure or because the app was closed before we finished, we will reuse the ones that have already completed downloading the next time the app starts up or the network connection is restored.</p>
<h3 id="updating-production-apps"><a class="anchor" href="#updating-production-apps" aria-hidden="true" data-scroll="">&#x1F517;</a>Updating apps in production</h3>

<p>Hot code push greatly improves the development experience, but on mobile, it is also a really useful feature for production apps, because it allows you to quickly push updates to devices without having users update the app through the store and without going through a possibly lengthy review process to get your update accepted.</p>
<p>However, it is important to realize that hot code push can only be used to update the HTML, CSS, JavaScript code and other assets making up your web app. Changes to native code will still require you <a href="#building-and-submitting">to submit a new version of your app to the store</a>.</p>
<p>In order to avoid a situation where JavaScript code that relies on changed native code is pushed to a client, we calculate a compatibility version from the Cordova platform and plugin versions, and only download a new version to a device when there is an exact match. This means any change to the list of plugins, or updating to a Meteor release which contains a new platform version, will block hot code push to existing mobile clients until the app has been updated from the store.</p>
<p>Something else to keep in mind is that your server-side code should be prepared to handle requests from older client versions, which may not yet have been updated. As you make changes to your data schema or publication functions for example, you may want to reflect on how this will impact backwards compatibility.</p>
<h3 id="configuring-server-for-hot-code-push"><a class="anchor" href="#configuring-server-for-hot-code-push" aria-hidden="true" data-scroll="">&#x1F517;</a>Configuring your server for hot code push</h3>

<p>As mentioned before, mobile apps need to be able to <a href="#connecting-to-the-server">connect to a server</a> to support hot code push. In production, you will need to specify which server to connect to <a href="#building-for-production">when building the app</a> using the <code>--server</code> option. The specified server address is used to set <code>ROOT_URL</code> in <code>__meteor_runtime_config__</code>, which is defined as part of the generated <code>index.html</code> in the app bundle.</p>
<p>In addition, you will need to configure the server with the right connection address. This happens automatically if you’re using <code>meteor deploy</code> to deploy to Galaxy, but when deploying to your own server you’ll have to make sure to define the <code>ROOT_URL</code> environment variable there. (For Meteor Up, you can configure this in <code>mup.json</code>.)</p>
<p>The reason this is needed is because updates delivered through hot code push replace the initially bundled <code>index.html</code> with a freshly generated one. If the <code>ROOT_URL</code> on your server hasn’t been set, it defaults to <code>localhost:3000</code>, and this would leave the app unable to connect to the server, both for data loading and for receiving further hot code pushes. In Meteor 1.3, we protect against this by blocking updates that would change the <code>ROOT_URL</code> to <code>localhost</code>, but the consequence of this is that hot code push is disabled until you configure <code>ROOT_URL</code> correctly.</p>
<h3 id="recovering-from-faulty-versions"><a class="anchor" href="#recovering-from-faulty-versions" aria-hidden="true" data-scroll="">&#x1F517;</a>Recovering from faulty versions</h3>

<p>Hot code pushing updated JavaScript code to a device could accidentally push code containing errors, which might leave users with a broken app (a ‘white screen of death’, in the worst case), and could even disable hot code push (because the code that makes a connection to the server may no longer run).</p>
<p>To avoid this, we try to detect faulty versions and revert to the last known good version when this happens. The way detection works is that we expect all <code>Meteor.startup()</code> callbacks to complete within a set period of time. If this doesn’t happen we consider the version faulty and will rollback the update. Unless the version on the server has been updated in the meantime, the server will try to hot code push the faulty version again. Therefore, we blacklist faulty versions on the device so we know not to retry.</p>
<p>By default, the startup timeout is set to 20 seconds. If your app needs more time to startup (or considerably less), you can use <a href="http://docs.meteor.com/#/full/App-setPreference" target="_blank" rel="external"><code>App.setPreference</code></a> to set <code>WebAppStartupTimeout</code> to another value.</p>
<h2 id="cordova-plugins"><a class="anchor" href="#cordova-plugins" aria-hidden="true" data-scroll="">&#x1F517;</a>Using native device features with Cordova plugins</h2>

<p>Cordova comes with a plugin architecture that opens up access to features not usually available to web apps. Plugins are installable add-ons that contain both JavaScript and native code, which allows them to translate calls from your web app to platform-specific APIs.</p>
<p>The Apache Cordova project maintains a set of <a href="https://cordova.apache.org/docs/en/dev/guide/support/index.html#core-plugin-apis" target="_blank" rel="external">core plugins</a> that provide access to various native device features such as the camera, contacts, or access to the file system. But anyone can write a Cordova plugin to do basically anything that can be done from native code, and many third-party plugins are available. You can <a href="https://cordova.apache.org/plugins/" target="_blank" rel="external">search for plugins on the Cordova website</a> or directly on <a href="https://www.npmjs.com/search?q=ecosystem%3Acordova" target="_blank" rel="external">npm</a>.</p>
<p>Be warned however, that although the core plugins are generally well maintained and up to date with the rest of Cordova, the quality of third-party plugins can be a bit of a gamble. You also have to make sure the plugin you want to use is <a href="#plugin-compatibility">compatible with the Cordova platform versions Meteor bundles</a>.</p>
<h3 id="installing-plugins"><a class="anchor" href="#installing-plugins" aria-hidden="true" data-scroll="">&#x1F517;</a>Installing plugins</h3>

<p>Plugins are identified by a name, which is generally the same as their npm package name. The current convention is for plugin names to start with <code>cordova-plugin-</code>, but not all third-party plugins adhere to this.</p>
<p>You can add Cordova plugins to your project either directly, or as a dependency of a Meteor package.</p>
<p>If you want to add a plugin to your project directly, you use the same <code>meteor add</code> command you use for Meteor packages, but with a <code>cordova:</code> prefix:</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meteor add cordova:cordova-plugin-camera@<span class="number">1.2</span>.<span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>In contrast to Meteor packages, you’ll have to specify the exact version of the plugin. This can be a bit of a pain because you first need to look up what the most recent <a href="#plugin-compatibility">(compatible)</a> version of a plugin is before you can add it.</p>
<p>A Meteor package can register a dependency on a Cordova plugin with the <code>Cordova.depends()</code> syntax. For example, a Meteor package that depends on the Cordova camera plugin would add the following to its <code>package.js</code>:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cordova.depends({</span><br><span class="line">    <span class="string">&apos;cordova-plugin-camera&apos;</span>: <span class="string">&apos;1.2.0&apos;</span></span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>This means adding the Meteor package to your project would also install the specified Cordova plugin.</p>
<blockquote>
<p>Note: If multiple Meteor packages add the same Cordova plugin but at different versions, there is no clear way of telling which version will end up being installed. Plugins added to your project directly however, will always override versions of the same plugin added as a dependency of packages.</p>
</blockquote>
<p>Because installing plugins into a Cordova project already containing plugins can lead to indeterminate results, Meteor will remove and add back all plugins whenever a change to any of the plugins in your project is made.</p>
<p>Cordova downloads plugins from npm, and caches them (in <code>~/.cordova/lib/npm_cache</code>) so they don’t have to be downloaded repeatedly if you rebuild or use them again in another project.</p>
<blockquote>
<h4 id="plugin-compatibility">Making sure a plugin is compatible with the bundled Cordova platform versions</h4>

<p>Because there is a tight coupling between plugin versions and Cordova platform versions, you may encounter build time or runtime errors as a result of incompatible plugins. If this happens, you will have to install a different plugin version, or it may turn out a plugin is not (yet) compatible with the Cordova platform versions we bundle.</p>
<p>In order to help with this, we pin core plugins to a minimum version known to work with the Cordova versions we bundle. This mechanism doesn’t apply to third-party plugins however, so you’ll have to assess compatibility for these yourself.</p>
<p>There is ongoing work in the Cordova project that will improve this situation and make it easier for plugins to specify their platform dependencies, so Cordova can determine compatible versions.</p>
</blockquote>
<h4>Setting plugin parameters</h4>

<p>Some Cordova plugins require certain parameters to be set as part of the build process. For example, <code>com-phonegap-plugins-facebookconnect</code> requires you to specify an <code>APP_ID</code> and <code>APP_NAME</code>. You can set these using <code>App.configurePlugin</code> in your <a href="http://docs.meteor.com/#mobileconfigjs" target="_blank" rel="external">mobile-config.js</a>.</p>
<h4>Installing a plugin from Git</h4>

<p>Alternatively, if unreleased changes have been made to a plugin you’d like to use, you can also have Cordova download plugin code from a Git repository. Note that this will clone the plugin repository on every rebuild however, so this can be rather slow and should be avoided where possible. In contrast to default Cordova, Meteor requires you to specify the exact SHA hash for a commit, rather than allow you to refer to a branch or tag. This is done to guarantee repeatable builds and also avoids unnecessary reinstallation of all plugins because as long as the SHA is the same we know nothing has changed.</p>
<p>The syntax to add a plugin from Git is kind of awkward. The name (the part before the <code>@</code>) is the plugin ID and will have to match what is specified in the plugin’s <code>plugin.xml</code>. Instead of a version, you specify a URL to a Git repository with the SHA hash as an anchor (the part after the <code>#</code>):</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meteor add cordova:com.phonegap.plugins.facebookconnect@https://github.com/Wizcorp/phonegap-facebook-plugin.git<span class="comment">#5dbb1583168558b4447a13235283803151cb04ec</span></span><br></pre></td></tr></tbody></table></figure>
<p>Meteor packages can also depend on plugins downloaded from Git:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cordova.depends({</span><br><span class="line">    <span class="string">&apos;com.phonegap.plugins.facebookconnect&apos;</span>: <span class="string">&apos;https://github.com/Wizcorp/phonegap-facebook-plugin.git#5dbb1583168558b4447a13235283803151cb04ec&apos;</span></span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<h4>Installing a plugin from the local file system</h4>

<p>Finally, especially if you’re developing your own plugin, installing it from the local filesystem can be a convenient way to keep up with changes you make to plugin code. The downside of this is that Meteor will reinstall all plugins on every build however, so this could really slow things down. We do add local plugins with the <code>--link</code> option however, so Cordova will try to install the plugin’s files using symlinks instead of copying them, which means changes to files will be reflected in the generated native project (e.g. an Xcode project) and may not require a rebuild.</p>
<p>You install plugins from the local file system by specifying a <code>file://</code> URL, which gets interpreted relative to the project directory:</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meteor add cordova:cordova-plugin-underdevelopment@file://../plugins/cordova-plugin-underdevelopment</span><br></pre></td></tr></tbody></table></figure>
<p>Meteor packages can also depend on plugins installed from the local file system, although this probably only makes sense for local packages:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cordova.depends({</span><br><span class="line">    <span class="string">&apos;cordova-plugin-underdevelopment&apos;</span>: <span class="string">&apos;file://../plugins/cordova-plugin-underdevelopment&apos;</span></span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<h4>Removing directly installed plugins</h4>

<p>You can remove a previously added plugin using <code>meteor remove</code>:</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">meteor remove cordova:cordova-plugin-camera</span><br><span class="line">meteor remove cordova:com.phonegap.plugins.facebookconnect</span><br><span class="line">meteor remove cordova:cordova-plugin-underdevelopment</span><br></pre></td></tr></tbody></table></figure>
<h3 id="using-plugins"><a class="anchor" href="#using-plugins" aria-hidden="true" data-scroll="">&#x1F517;</a>Using plugins</h3>

<p>You should wrap any functionality which relies on a Cordova plugin in a <code>Meteor.startup()</code> block to make sure the plugin has been fully initialized (by listening to the <code>deviceready</code> event). For example, when using the Cordova geolocation plugin:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The plugin may not have been initialized here</span></span><br><span class="line">navigator.geolocation.getCurrentPosition(success);</span><br><span class="line"></span><br><span class="line">Meteor.startup(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{</span><br><span class="line">    <span class="comment">// Here we can be sure the plugin has been initialized</span></span><br><span class="line">    navigator.geolocation.getCurrentPosition(success);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<h3 id="cordova-specific-javascript"><a class="anchor" href="#cordova-specific-javascript" aria-hidden="true" data-scroll="">&#x1F517;</a>Adding Cordova-specific Javascript code to your application</h3>

<p>Just as you can use <code>Meteor.isServer</code> and <code>Meteor.isClient</code> to separate your client-side and server-side code, you can use <code>Meteor.isCordova</code> to separate your Cordova-specific code from the rest of your code.</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (Meteor.isServer) {</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Printed on the server&quot;</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Meteor.isClient) {</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Printed in browsers and mobile apps&quot;</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Meteor.isCordova) {</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Printed only in mobile Cordova apps&quot;</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>In addition, packages can include a different set of files for Cordova builds and browser builds with <code>addFiles</code>:</p>
<ul>
<li><code>api.addFiles(&apos;foo.js&apos;, &apos;web.cordova&apos;)</code>: includes <code>foo.js</code> in only Cordova builds.</li>
<li><code>api.addFiles(&apos;bar.js&apos;, &apos;web.browser&apos;)</code>: includes <code>bar.js</code> in only browser builds.</li>
<li><code>api.addFiles(&apos;baz.js&apos;, &apos;web&apos;)</code>: includes <code>baz.js</code> in all client builds.</li>
</ul>
<p>The same syntax can be used for <code>api.use</code>, <code>api.imply</code>, and <code>api.export</code>.</p>
<h2 id="accessing-local-files-and-remote-resources"><a class="anchor" href="#accessing-local-files-and-remote-resources" aria-hidden="true" data-scroll="">&#x1F517;</a>Accessing local files and remote resources</h2>

<p>As a web app, Cordova apps are subject to various security mechanisms designed to protect the integrity of your code and to avoid certain types of attacks. Which security mechanisms are in use may depend on the type and version of the web view your app runs in. In addition, Cordova itself, and in some cases the OS, adds different levels of access control that may also affect what content can and cannot be loaded. All this can make it fairly confusing to understand why something is not working, and even harder to understand the security implications of the various ways of configuring these mechanisms.</p>
<h3 id="accessing-local-files"><a class="anchor" href="#accessing-local-files" aria-hidden="true" data-scroll="">&#x1F517;</a>Accessing local files</h3>

<p>Because the Cordova integration in Meteor does not serve your app from <code>file://</code> URLs, access to local files through <code>file://</code> URLs is not allowed either due to the <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy" target="_blank" rel="external">same-origin policy</a>.</p>
<p>The file serving mechanism used in Meteor allows for local file access through URLs of the form <code>http://localhost:&lt;port&gt;/local-filesystem/&lt;path&gt;</code>) however. You can construct these file system URLs manually, or use <code>WebAppLocalServer.localFileSystemUrl()</code> to convert <code>file://</code> URLs. You can use this to convert URLs received from plugins like <code>cordova-plugin-file</code> and <code>cordova-plugin-camera</code> for example.</p>
<h3 id="accessing-local-files"><a class="anchor" href="#accessing-local-files" aria-hidden="true" data-scroll="">&#x1F517;</a>Domain whitelisting</h3>

<p>Cordova controls access to external domains through a whitelisting mechanism, which is implemented as <a href="https://github.com/apache/cordova-plugin-whitelist" target="_blank" rel="external"><code>cordova-plugin-whitelist</code></a> in the version of Cordova we bundle.</p>
<p>In Meteor, you use <a href="http://docs.meteor.com/#/full/App-accessRule" target="_blank" rel="external"><code>App.accessRule</code></a> in <code>mobile-config.js</code> to set additional rules. (These correspond to <code>&lt;access&gt;</code>, <code>&lt;allow-navigation&gt;</code> and <code>&lt;allow-intent&gt;</code> tags in the generated <code>config.xml</code>.)</p>
<blockquote>
<p>On iOS, these settings also control <a href="https://developer.apple.com/library/prerelease/ios/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW33" target="_blank" rel="external">Application Transport Security (ATS)</a>, which is an OS level mechanism to enforce security best practices new to iOS 9. If the server you’re connecting to does not (yet) fulfill these requirements, you can use additional options to override them for specific domains:<br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">App.accessRule(<span class="string">&apos;https://domain.com&apos;</span>, {</span><br><span class="line">  <span class="string">&apos;minimum-tls-version&apos;</span>: <span class="string">&apos;TLSv1.0&apos;</span>,</span><br><span class="line">  <span class="string">&apos;requires-forward-secrecy&apos;</span>: <span class="literal">false</span>,</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><p></p>
</blockquote>
<p>By default, Cordova apps in Meteor are only allowed access to <code>localhost</code> (the device itself, to serve the app from) and the server your app connects to for data loading and hot code push (either an automatically detected IP address an explicitly configured mobile server domain). These restrictions also apply to loading files in iframes and to opening files in other apps (including the mobile browser).</p>
<blockquote>
<p>Note that these restrictions mean you will have to explicitly allow loading <code>data:</code> URLs. For example, to allow loading <code>data:</code> URLs in iframes you would add:<br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">App.accessRule(<span class="string">&apos;data:*&apos;</span>, { type: <span class="string">&apos;navigation&apos;</span> });</span><br></pre></td></tr></tbody></table></figure><p></p>
</blockquote>
<h3 id="csp"><a class="anchor" href="#csp" aria-hidden="true" data-scroll="">&#x1F517;</a>Content Security Policy (CSP)</h3>

<p>In addition to the domain whitelisting mechanism Cordova implements, the web view itself may also enforce access rules through <a href="https://developer.mozilla.org/en-US/docs/Web/Security/CSP" target="_blank" rel="external">Content Security Policy (CSP)</a>. For now, Meteor adds a permissive <code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;...&quot;</code> header to the generated index page. We may want to allow more fine grained control in the future (through integrating with the <code>browser-policy</code> package for instance.)</p>
<h3 id="cors"><a class="anchor" href="#cors" aria-hidden="true" data-scroll="">&#x1F517;</a>Cross-Origin Resource Sharing (CORS)</h3>

<p>What is often confusing to people is that setting <code>App.accessRule</code> is not enough to allow access to remote resources. While domain whitelisting allows the client to control which domains it can connect to, additional restrictions based on the <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy" target="_blank" rel="external">same-origin policy</a> also apply. By default, web views will not allow  cross-origin HTTP requests initiated from JavaScript for instance, so you will likely run into this when using <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" target="_blank" rel="external"><code>XMLHttpRequest</code></a>.</p>
<p>To get around these restrictions, you’ll have to use what is known as <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="external">Cross-Origin Resource Sharing (CORS)</a>. In contrast to the whitelisting mechanism configured on the client, CORS relies on headers set by the server. In other words, in order to allow access to a remote resource, you may have to make configuration changes on the server, such as setting a <code>Access-Control-Allow-Origin</code> header.</p>
<h2 id="configuring-your-app"><a class="anchor" href="#configuring-your-app" aria-hidden="true" data-scroll="">&#x1F517;</a>Configuring your app</h2>

<p>Meteor reads a <a href="http://docs.meteor.com/#/full/mobileconfigjs" target="_blank" rel="external"><code>mobile-config.js</code></a> file in the root of your app directory during build, and uses the settings specified there to generate Cordova’s <a href="https://cordova.apache.org/docs/en/dev/config_ref/index.html" target="_blank" rel="external"><code>config.xml</code></a>.</p>
<h3 id="configuring-metadata"><a class="anchor" href="#configuring-metadata" aria-hidden="true" data-scroll="">&#x1F517;</a>Metadata</h3>

<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">App.info({</span><br><span class="line">  id: <span class="string">&apos;com.meteor.examples.todos&apos;</span>,</span><br><span class="line">  name: <span class="string">&apos;Todos&apos;</span>,</span><br><span class="line">  version: <span class="string">&quot;0.0.1&quot;</span></span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<h3 id="configuring-preferences"><a class="anchor" href="#configuring-preferences" aria-hidden="true" data-scroll="">&#x1F517;</a>Preferences</h3>

<figure class="highlight actionscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">App.setPreference(<span class="string">&apos;BackgroundColor&apos;</span>, <span class="string">&apos;0xff0000ff&apos;</span>);</span><br><span class="line">App.setPreference(<span class="string">&apos;Orientation&apos;</span>, <span class="string">&apos;default&apos;</span>);</span><br><span class="line">App.setPreference(<span class="string">&apos;Orientation&apos;</span>, <span class="string">&apos;all&apos;</span>, <span class="string">&apos;ios&apos;</span>);</span><br></pre></td></tr></tbody></table></figure>
<p>Refer to the <a href="https://cordova.apache.org/docs/en/dev/config_ref/index.html#preference" target="_blank" rel="external">preferences section</a> of the Cordova documentation for more information about supported options.</p>
<h3 id="configuring-app-icons-and-launch-screens"><a class="anchor" href="#configuring-app-icons-and-launch-screens" aria-hidden="true" data-scroll="">&#x1F517;</a>App icons and launch screens</h3>

<p>Although Meteor includes a standard set of app icons and launch screens, you’ll most likely want to configure your own images.</p>
<p>You configure these images with <a href="http://docs.meteor.com/#/full/App-icons" target="_blank" rel="external"><code>App.icons</code></a> and <a href="http://docs.meteor.com/#/full/App-launchScreens" target="_blank" rel="external"><code>App.launchScreens</code></a>, which both use names to refer to the various supported image sizes (see API documentation).</p>
<p>For iOS, you can also refer to the <a href="https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/MobileHIG/IconMatrix.html" target="_blank" rel="external">Icon and image sizes</a> in the iOS Human Interface Guidelines for more information about the way these different sizes are used.</p>
<h3 id="advanced-build"><a class="anchor" href="#advanced-build" aria-hidden="true" data-scroll="">&#x1F517;</a>Advanced build customization</h3>

<p>There is a special top-level directory named <code>cordova-build-override/</code> that allows you to override, in an ad-hoc way, parts of your Cordova project that Meteor generates for you in the <code>.meteor/local/cordova-build</code> directory. The entire file tree of this directory will be <code>cp -R</code> (copied overwriting existing files) to the Cordova project right before the build and compilation step.</p>
<p>The problem with this mechanism is that it overrides complete files, so it is not a good solution for customizing <code>config.xml</code>. Replacing the generated version with your own file means you lose all configuration information set by the build process and by installed plugins, which will likely break your app.</p>
<p>If you need to customize configuration files, a workaround is to create a dummy Cordova plugin. In its <code>plugin.xml</code>, you can specify a <a href="https://cordova.apache.org/docs/en/dev/plugin_ref/spec.html#config-file" target="_blank" rel="external"><code>config-file</code> element</a> to selectively change parts of configuration files, including <code>config.xml</code>.</p>
<blockquote>
<p>We recommend using these approaches only if absolutely required and if your customizations can not be handled by standard configuration options.</p>
</blockquote>
<h2 id="building-and-submitting"><a class="anchor" href="#building-and-submitting" aria-hidden="true" data-scroll="">&#x1F517;</a>Submitting your mobile app to the store</h2>

<h3 id="building-for-production"><a class="anchor" href="#building-for-production" aria-hidden="true" data-scroll="">&#x1F517;</a>Building your mobile app for production</h3>

<p>Use <code>meteor build &lt;build-output-directory&gt; --server &lt;host&gt;:&lt;port&gt;</code> to build your app for production.</p>
<p>The <code>&lt;host&gt;</code> and <code>&lt;port&gt;</code> should be the address of the server you want your app to connect to.</p>
<p>This will generate a directory at <code>&lt;build-output-directory&gt;</code>, which includes a server bundle tarball and the project source for each targeted mobile platform in the <code>/ios</code> and <code>/android</code> directories.</p>
<p>You can pass <code>--server-only</code> to only build the server bundle. This allows you to build your app without installing the mobile SDKs on the build machine. This is useful if you use an automated deployment setup for instance. (If you remove the mobile platforms before building instead, hot code push will be disabled because the assets for Cordova included in the server bundle will not be generated.)</p>
<h3 id="submitting-ios"><a class="anchor" href="#submitting-ios" aria-hidden="true" data-scroll="">&#x1F517;</a>How to submit your iOS app to the App Store</h3>

<p>In order to build your app for iOS, you will need to <a href="#configuring-your-app">configure your app</a> with at least a version number, and the required set of app icons and launch screens.</p>
<p>After running <code>meteor build</code> you can open the generated Xcode project in Xcode:<br></p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;build-output-directory&gt;/ios/project</span><br><span class="line">open MyApp.xcodeproj</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>From this point on, the process for building the app archive and submitting it to the App Store is the same as it would be for any other iOS app. Please refer to <a href="https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/SubmittingYourApp/SubmittingYourApp.html" target="_blank" rel="external">Apple’s documentation</a> for further details.</p>
<h3 id="submitting-android"><a class="anchor" href="#submitting-android" aria-hidden="true" data-scroll="">&#x1F517;</a>How to submit your Android app to the Play Store</h3>

<p>In order to build your app for Android, you will need to <a href="#configuring-your-app">configure your app</a> with at least a version number, and the required set of app icons and launch screens.</p>
<p>After running <code>meteor build</code> the generated APK will be copied from the <code>&lt;build-output-directory&gt;/android/project/build/outputs/apk</code> directory to <code>&lt;build-output-directory&gt;/android/release-unsigned.apk</code>.</p>
<p>Before submitting the APK(s) to the Play Store, you will need to sign the APK and run <a href="http://developer.android.com/tools/help/zipalign.html" target="_blank" rel="external"><code>zipalign</code></a> on it to optimize the archive.</p>
<p>(See the <a href="http://developer.android.com/tools/publishing/app-signing.html" target="_blank" rel="external">Android developer documentation</a> for more details about the app signing procedure.)</p>
<p>To sign your app, you’ll need a private key. This key lets you publish and update your app. If you haven’t made a key for this app yet, run:<br></p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkey -alias your-app-name -keyalg RSA -keysize <span class="number">2048</span> -validity <span class="number">10000</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Optionally, you can specify <code>--keystore</code> to use a different keystore. Don’t forget to specify the same keystore when signing the APK.</p>
<blockquote>
<p>Note: Ensure that you have secure backups of your keystore (<code>~/.keystore</code> is the default). If you publish an app to the Play Store and then lose the key with which you signed your app, you will not be able to publish any updates to your app, since you must always sign all versions of your app with the same key.</p>
</blockquote>
<p>Now, you can sign the APK:<br></p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/build-output-directory/android/</span><br><span class="line">jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 release-unsigned.apk your-app-name</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Next, you can run zipalign on it to optimize the APK:<br></p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ANDROID_HOME</span>/build-tools/&lt;build-tools-version&gt;/zipalign <span class="number">4</span> release-unsigned.apk &lt;your-app-name&gt;.apk</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>From this point on, the process for submitting the app to the Play Store is the same as it would be for any other Android app. <code>&lt;your-app-name&gt;.apk</code> is the APK to upload to the store. Learn more by visiting <a href="https://play.google.com/apps/publish" target="_blank" rel="external">https://play.google.com/apps/publish</a>.</p>
<h4>Submitting an app using Crosswalk to to Play Store</h4>

<p>Because Crosswalk bundles native code for Chromium, you will end up with APKs for both ARM and x86. You can find the generated APKs in the <code>&lt;build-output-directory&gt;/android/project/build/outputs/apk</code> directory.</p>
<p>You will have to sign and <code>zipalign</code> both APKs. You will also have to submit both to the Play Store, see  <a href="http://developer.android.com/google/play/publishing/multiple-apks.html" target="_blank" rel="external">submitting multiple APKs</a> for more information.</p>

    <div class="bottom-nav">
      
      
        <span>← <a href="guide-writing-packages-1.3.html">Writing Packages</a></span>
      
      
        <span style="float:right"><a href="guide-build-tool-1.3.html">Build system</a> →</span>
      
    </div>
    <p class="edit-link">
      <a href="https://github.com/meteor/guide/tree/master/content/mobile.md" target="_blank">Edit this page on GitHub</a>
    </p>
    
      <div id="discourse-comments"><iframe src="https://forums.meteor.com/embed/comments?topic_id=20195" id="discourse-embed-frame" width="100%" frameborder="0" scrolling="no" height="746px"></iframe></div>

      
    
  </div>

  <!-- mobile only -->
  <div id="mobile-header">
    <a class="menu-button"></a>
    <a class="logo" href="/">
      <img src="http://guide.meteor.com/images/logo.svg">
    </a>
  </div>
  <div id="mobile-shade"></div>

</div>

    
    
    
    
  

<div class="st-injected-content-generated st-install-h1KW95Mz3fNyf4cnqVtr" data-st-install-key="h1KW95Mz3fNyf4cnqVtr" id="st-injected-content">
<div class="st-ui-embed st-search-chrome-overlay-output st-search-escape-hide-outputs st-search-zoom-on-mobile" style="display: none; ">
    <div class="st-ui-overlay st-search-hide-outputs"></div>
  <!-- Swiftype input and results overlay -->
  <div class="st-ui-container st-ui-container-overlay  st-ui-injected-overlay-container ">
    <!-- HEADER -->
    <div class="st-ui-container-header_bar st-position-container">
        <section class="st-ui-header">
          <form>
            <input class="st-default-search-input st-search-set-focus" type="text" value="" placeholder="Search this site" id="st-overlay-search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
          </form>
          <span class="st-ui-search-icon"></span>

            <a class="st-ui-close-button st-search-hide-outputs">Close</a>

            <a class="st-ui-stamp" href="https://swiftype.com" target="_blank">search by swiftype</a>
        </section>
    </div>

    <!-- LEFT SIDEBAR -->
    <div class="st-ui-container-left_sidebar st-position-container">
      <div class="st-ui-injected-search-controls">
      </div>
    </div>

    <!-- RIGHT SIDEBAR -->
    <div class="st-ui-container-right_sidebar st-position-container">
      <div class="st-ui-injected-container-right_sidebar">
        <div class="st-ui-injected-search-controls">
        </div>
      </div>
    </div>

    <!-- PRIMARY CONTENT -->
    <div class="st-ui-container-primary_content st-position-container">
        <section class="st-ui-slide-autocomplete st-autocomplete-keyboard-navigable st-autocomplete-transient-on-select-and-results" data-st-target-element="#st-overlay-search-input" data-st-active-query-class="active" style="display: none; ">
          <span class="st-ui-type-heading-small">suggested results</span>
          <div class="st-autocomplete-results"><div class="st-query-present" style="display: none; "></div></div>
        </section>

        <section class="st-ui-content st-search-results"><div class="st-query-not-present">
          <span class="st-ui-fallback"></span>
        </div><div class="st-query-present" style="display: none; "></div></section>

      <section class="st-ui-no-results st-search-suggestions"><div class="st-query-not-present">
      </div></section>
    </div>



    <!-- FOOTER -->
    <div class="st-ui-container-footer_bar st-position-container">
      <section class="st-ui-footer">
          <span class="st-ui-search-summary st-search-summary"></span>
        <span class="st-ui-pagination st-search-pagination"></span>
      </section>
    </div>
  </div>
</div>
<div class="st-default-autocomplete" data-st-target-element=".st-default-search-input" style="position: absolute; top: 49px; left: 0px; z-index: 999999; display: none; ">
  <div class="st-autocomplete-results st-ui-autocomplete"><div class="st-query-present" style="display: none; "></div></div>
</div>
</div><script>if(window.location.hash==="#showoriginal"){var nodes=document.getElementsByClassName("original");for(var i=0;i<nodes.length;i++){nodes[i].style.display="initial";}}</script></body></html>